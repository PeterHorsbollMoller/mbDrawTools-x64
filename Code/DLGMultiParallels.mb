'*******************************************************************************
'** 	Created By Peter Horsbøll Møller, Precisely
'** 	Program:
'** 	Modul:
'**
'*******************************************************************************

'-------------------------------------
Include "MapBasic.def"
Include "Icons.def"
Include "Menu.def"
'**default constants...
Include "Library\Defaults.def"

'-------------------------------------
Include "Library\DEBUGLib.def"
Include "Library\ERRORLib.def"
Include "Library\TABLELib.def"

Include "DLGMultiParallels.def"

Dim	mnNumParallels, mnOrientation As Integer,
	mfDistance As Float
'**********************************************************************************************''
'Created by Peter Horsbøll Møller, Precisely
'Parameters:
'	:
'Return value:
'
'**********************************************************************************************''
Function DLGMultiParallels(	  ByVal nNumParallels As Integer
						, ByVal fDistance As Float
'						, ByVal fDirection As Float
						, ByVal nOrientation As Integer
						, ByVal sDistanceUnits As String
						) As Logical

Dim	sNumParallels, sDistance, sDirection As String

DLGMultiParallels = FALSE

OnError GoTo ErrorOccured

	Dialog
		Title "Create Multiple Parallels"

		Control StaticText	Position 5,5
			Title "Number of Parallels"
		Control EditText	Position 5,15		Width 100
			Value FormatNumber$(nNumParallels)
			Into sNumParallels

		Control StaticText	Position 5,30
			Title "Distance, " & sDistanceUnits
		Control EditText	Position 5,40		Width 100
			Value FormatNumber$(Round(fDistance, 0.01))
			Into sDistance

'		Control StaticText	Position 5,55
'			Title "Direction"
'		Control EditText	Position 5,65		Width 100
'			Value FormatNumber$(Round(fDirection, 0.01))
'			Into sDirection

		Control StaticText	Position 5,55
			Title "Orientation"
		Control PopupMenu	Position 5,65		Width 100
			Title "Left Side;Right Side;Both Sides"
			Value nOrientation
			Into mnOrientation

		Control OKButton
		Control CancelButton

	If not CommandInfo(CMD_INFO_DLG_OK) Then
		Exit Function
	End If

	mnNumParallels	= DeformatNumber$(sNumParallels)
	mfDistance	= DeformatNumber$(sDistance)

	If mnNumParallels <= 0 Then
		Note "Please specify a number of parallels bigger than 0"
		Exit Function
	ElseIf mfDistance <= 0 Then
		Note "Please specify a distance bigger than 0"
		Exit Function
	End If

	DLGMultiParallels = TRUE
	Exit Function
'-------------------------
ErrorOccured:
	Call ERRCreate(Err(), Error$(), "PleaseEnterNameOfFunctionHere")
	Call ERRShow()

End Function


'************************************************************************
Function DLGMPGetNumParallels() As Integer

OnError GoTo ErrorOccured

	DLGMPGetNumParallels = IIf(mnNumParallels = 0, 1, mnNumParallels)
	Exit Function
'-------------------------
ErrorOccured:
	Call ERRCreate(Err(), Error$(), "DLGMPGetNumParallels")
	Call ERRShow()

End Function

'************************************************************************
Function DLGMPGetDistance() As Float

OnError GoTo ErrorOccured

	DLGMPGetDistance = mfDistance
	Exit Function
'-------------------------
ErrorOccured:
	Call ERRCreate(Err(), Error$(), "DLGMPGetDistance")
	Call ERRShow()

End Function

'************************************************************************
Function DLGMPGetOrientation() As Integer

OnError GoTo ErrorOccured

	DLGMPGetOrientation = IIf(mnOrientation = 0, 1, mnOrientation)
	Exit Function
'-------------------------
ErrorOccured:
	Call ERRCreate(Err(), Error$(), "DLGMPGetOrientation")
	Call ERRShow()

End Function